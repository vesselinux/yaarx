<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>YAARX: Yet Another ARX Toolkit: include/tea-f-add-pddt.hh File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="logo.jpg"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">YAARX: Yet Another ARX Toolkit
   &#160;<span id="projectnumber">0.1</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('tea-f-add-pddt_8hh.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tea-f-add-pddt.hh File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="tea-f-add-pddt_8cc.html" title="Computing an ADD partial difference distribution table (pDDT) for the F-function of block cipher TEA...">tea-f-add-pddt.cc</a>. <p>Computing an ADD partial difference distribution table (pDDT) for the F-function of block cipher TEA. </p>
.  
<a href="#details">More...</a></p>

<p><a href="tea-f-add-pddt_8hh_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-f-add-pddt_8hh.html#a9a9b0ca87b727a966ffb1842ffa389e3">rsh_condition_is_sat</a> (const uint32_t k, const uint32_t new_da, const uint32_t new_dc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-f-add-pddt_8hh.html#a55f531edb6fd0ce85c20b47e890475e3">lsh_condition_is_sat</a> (const uint32_t k, const uint32_t new_da, const uint32_t new_db)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-f-add-pddt_8hh.html#ae8e09fe95cc3eb4257b868d91f8924ec">tea_f_add_pddt_i</a> (const uint32_t k, const uint32_t n, const uint32_t lsh_const, const uint32_t rsh_const, gsl_matrix *A[2][2][2][2], gsl_vector *C, uint32_t *da, uint32_t *db, uint32_t *dc, uint32_t *dd, double *p, const double p_thres, std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *diff_set_dx_dy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-f-add-pddt_8hh.html#af962bfb5724a4f1dd45fdb2fdeac49f4">tea_f_add_pddt</a> (uint32_t n, double p_thres, uint32_t lsh_const, uint32_t rsh_const, std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *diff_set_dx_dy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-f-add-pddt_8hh.html#a82603f2a5c7ada2fad8d82f93287ff05">is_dx_in_set_dx_dy</a> (uint32_t dy, uint32_t dx_prev, std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; diff_set_dx_dy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa6c5708f75451dca26796f0e644651e6"></a><!-- doxytag: member="tea&#45;f&#45;add&#45;pddt.hh::tea_f_da_add_pddt_i" ref="aa6c5708f75451dca26796f0e644651e6" args="(const uint32_t k, const uint32_t n, const uint32_t lsh_const, const uint32_t rsh_const, gsl_matrix *A[2][2][2][2], gsl_vector *C, const uint32_t da, uint32_t *db, uint32_t *dc, uint32_t *dd, double *p, const double p_thres, std::set&lt; differential_t, struct_comp_diff_dx_dy &gt; *diff_set_dx_dy, std::multiset&lt; differential_t, struct_comp_diff_p &gt; *diff_mset_p, uint32_t *cnt_new)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>tea_f_da_add_pddt_i</b> (const uint32_t k, const uint32_t n, const uint32_t lsh_const, const uint32_t rsh_const, gsl_matrix *A[2][2][2][2], gsl_vector *C, const uint32_t da, uint32_t *db, uint32_t *dc, uint32_t *dd, double *p, const double p_thres, std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *diff_set_dx_dy, std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *diff_mset_p, uint32_t *cnt_new)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-f-add-pddt_8hh.html#a379d6e4054b1bf78e6068f4cbdd06065">tea_f_da_add_pddt</a> (uint32_t n, double p_thres, uint32_t lsh_const, uint32_t rsh_const, const uint32_t da, const uint32_t da_prev, std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *hways_diff_set_dx_dy, std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *hways_diff_mset_p, std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *diff_set_dx_dy, std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *diff_mset_p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-f-add-pddt_8hh.html#aa60ac75c659872644ff116ea451bed41">tea_f_add_pddt_adjust_to_key</a> (uint32_t nrounds, uint32_t npairs, uint32_t key[4], double p_thres, std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *diff_set_dx_dy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-f-add-pddt_8hh.html#a6334dfbee70edb6980086f15da98f826">tea_f_add_pddt_dxy_to_dp</a> (std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *diff_mset_p, const std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; diff_set_dx_dy)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-f-add-pddt_8hh.html#ad6e23f144fd280b089361de9cad58121">tea_f_add_pddt_exper</a> (gsl_matrix *A[2][2][2][2], uint32_t n, double p_thres, uint32_t lsh_const, uint32_t rsh_const, std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *diff_mset_p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tea-f-add-pddt_8hh.html#a630bf3eeaef1d61366bfc0ab790f6ab7">tea_f_add_pddt_fk_exper</a> (uint32_t n, double p_thres, uint32_t delta, uint32_t k0, uint32_t k1, uint32_t lsh_const, uint32_t rsh_const, std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *diff_mset_p)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="tea-f-add-pddt_8cc.html" title="Computing an ADD partial difference distribution table (pDDT) for the F-function of block cipher TEA...">tea-f-add-pddt.cc</a>. <p>Computing an ADD partial difference distribution table (pDDT) for the F-function of block cipher TEA. </p>
. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>V.Velichkov, <a href="mailto:vesselin.velichkov@uni.lu">vesselin.velichkov@uni.lu</a> </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>2012-2013 </dd></dl>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a82603f2a5c7ada2fad8d82f93287ff05"></a><!-- doxytag: member="tea&#45;f&#45;add&#45;pddt.hh::is_dx_in_set_dx_dy" ref="a82603f2a5c7ada2fad8d82f93287ff05" args="(uint32_t dy, uint32_t dx_prev, std::set&lt; differential_t, struct_comp_diff_dx_dy &gt; diff_set_dx_dy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="tea-f-add-pddt_8hh.html#a82603f2a5c7ada2fad8d82f93287ff05">is_dx_in_set_dx_dy</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>dx_prev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt;&#160;</td>
          <td class="paramname"><em>diff_set_dx_dy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>For a given difference dx, check if in the list of differentials set_dx_dy exists an entry (dx -&gt; dy) </p>

</div>
</div>
<a class="anchor" id="a55f531edb6fd0ce85c20b47e890475e3"></a><!-- doxytag: member="tea&#45;f&#45;add&#45;pddt.hh::lsh_condition_is_sat" ref="a55f531edb6fd0ce85c20b47e890475e3" args="(const uint32_t k, const uint32_t new_da, const uint32_t new_db)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="tea-f-add-pddt_8hh.html#a55f531edb6fd0ce85c20b47e890475e3">lsh_condition_is_sat</a> </td>
          <td>(</td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>new_da</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>new_db</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Check if two differences <img class="formulaInl" alt="$da$" src="form_405.png"/> and <img class="formulaInl" alt="$dc$" src="form_406.png"/>, partially constructed up to bit <img class="formulaInl" alt="$k$" src="form_246.png"/> (<a class="el" href="common_8hh.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a> <img class="formulaInl" alt="$> k \ge 0$" src="form_211.png"/>), are valid input and output difference respectively, for the <a class="el" href="common_8hh.html#ab0642bbe3fc1b4488b5fd0e8ea1d1d88">LSH</a> operation.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>bit position: <a class="el" href="common_8hh.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a> <img class="formulaInl" alt="$> k \ge 0$" src="form_211.png"/>. </td></tr>
    <tr><td class="paramname">new_da</td><td>input difference to <a class="el" href="common_8hh.html#ab0642bbe3fc1b4488b5fd0e8ea1d1d88">LSH</a> partially constructed up to bit <img class="formulaInl" alt="$k$" src="form_246.png"/>. </td></tr>
    <tr><td class="paramname">new_db</td><td>output difference from <a class="el" href="common_8hh.html#ab0642bbe3fc1b4488b5fd0e8ea1d1d88">LSH</a> partially constructed up to bit <img class="formulaInl" alt="$k$" src="form_246.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if <img class="formulaInl" alt="$dc$" src="form_406.png"/>, after being fully constructed, will be a valid output difference from <a class="el" href="common_8hh.html#ab0642bbe3fc1b4488b5fd0e8ea1d1d88">LSH</a>, given the input difference <img class="formulaInl" alt="$da$" src="form_405.png"/>; FALSE otherwise.</dd></dl>
<p><b>More</b> <b>Details:</b> </p>
<ol type="1">
<li>If <img class="formulaInl" alt="$ k < L $" src="form_446.png"/>: check if <img class="formulaInl" alt="$db[k:0] = 0$" src="form_441.png"/>.</li>
<li>If <img class="formulaInl" alt="$k \ge L$" src="form_442.png"/>: check if <img class="formulaInl" alt="$(db \gg L)[n-(k-L+1):0] = da[n-(k-L+1):0]$" src="form_443.png"/>.</li>
</ol>
<p>where <img class="formulaInl" alt="$L =$" src="form_444.png"/>TEA_LSH_CONST, <img class="formulaInl" alt="$n=$" src="form_445.png"/><a class="el" href="common_8hh.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a>.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="tea-f-add-pddt_8hh.html#a9a9b0ca87b727a966ffb1842ffa389e3">rsh_condition_is_sat</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a9a9b0ca87b727a966ffb1842ffa389e3"></a><!-- doxytag: member="tea&#45;f&#45;add&#45;pddt.hh::rsh_condition_is_sat" ref="a9a9b0ca87b727a966ffb1842ffa389e3" args="(const uint32_t k, const uint32_t new_da, const uint32_t new_dc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="tea-f-add-pddt_8hh.html#a9a9b0ca87b727a966ffb1842ffa389e3">rsh_condition_is_sat</a> </td>
          <td>(</td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>new_da</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>new_dc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Check if two differences <img class="formulaInl" alt="$da$" src="form_405.png"/> and <img class="formulaInl" alt="$dc$" src="form_406.png"/>, partially constructed up to bit <img class="formulaInl" alt="$k$" src="form_246.png"/> (<a class="el" href="common_8hh.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a> <img class="formulaInl" alt="$> k \ge 0$" src="form_211.png"/>), are valid input and output difference respectively, for the <a class="el" href="common_8hh.html#aa1542fdafaf6b27d057c000486b42133">RSH</a> operation. From the partial information for <img class="formulaInl" alt="$dc$" src="form_406.png"/>, the algorithm estimates if <img class="formulaInl" alt="$dc$" src="form_406.png"/> belongs to one of the four possible differences after the <a class="el" href="common_8hh.html#aa1542fdafaf6b27d057c000486b42133">RSH</a> operation (see <a class="el" href="adp-shift_8hh.html#a06fffd781af6662482922889bc562caf">adp_rsh</a>): <img class="formulaInl" alt="$\{(da \gg R),~ (da \gg R) + 1,~ (da \gg R) - 2^{n-R},~ (da \gg R) - 2^{n-R} + 1\}$" src="form_437.png"/>, where <img class="formulaInl" alt="$R$" src="form_318.png"/> is the <a class="el" href="common_8hh.html#aa1542fdafaf6b27d057c000486b42133">RSH</a> constant (TEA_RSH_CONST).</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>bit position: <a class="el" href="common_8hh.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a> <img class="formulaInl" alt="$> k \ge 0$" src="form_211.png"/>. </td></tr>
    <tr><td class="paramname">new_da</td><td>input difference to <a class="el" href="common_8hh.html#aa1542fdafaf6b27d057c000486b42133">RSH</a> partially constructed up to bit <img class="formulaInl" alt="$k$" src="form_246.png"/>. </td></tr>
    <tr><td class="paramname">new_dc</td><td>output difference from <a class="el" href="common_8hh.html#aa1542fdafaf6b27d057c000486b42133">RSH</a> partially constructed up to bit <img class="formulaInl" alt="$k$" src="form_246.png"/>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if <img class="formulaInl" alt="$dc$" src="form_406.png"/>, after being fully constructed, will be a valid output difference from <a class="el" href="common_8hh.html#aa1542fdafaf6b27d057c000486b42133">RSH</a>, given the input difference <img class="formulaInl" alt="$da$" src="form_405.png"/>; FALSE otherwise.</dd></dl>
<dl class="attention"><dt><b>Attention:</b></dt><dd>The function is <em>not</em> optimal, meaning that it is overly-restrictive: all diferences <img class="formulaInl" alt="$(da,dc)$" src="form_435.png"/> which pass the checks are valid, but there also exist valid differences that do not pass the checks. The reason is that it is hard to detect all valid differences before they have been fully constructed.</dd></dl>
<p><b>More</b> <b>Details:</b> </p>
<p>Given are two differences <img class="formulaInl" alt="$da$" src="form_405.png"/> and <img class="formulaInl" alt="$dc$" src="form_406.png"/>, that are only partially constructed up to bit <img class="formulaInl" alt="$k$" src="form_246.png"/> (counting from the LSB <img class="formulaInl" alt="$k = 0$" src="form_268.png"/>). <a class="el" href="tea-f-add-pddt_8hh.html#a9a9b0ca87b727a966ffb1842ffa389e3">rsh_condition_is_sat</a> performs checks on <img class="formulaInl" alt="$da$" src="form_405.png"/> and <img class="formulaInl" alt="$dc$" src="form_406.png"/> and outputs if <img class="formulaInl" alt="$dc$" src="form_406.png"/> is such that <img class="formulaInl" alt="$dc = da \gg R$" src="form_410.png"/>, where <img class="formulaInl" alt="$R$" src="form_318.png"/> = TEA_RSH_CONST. The idea is to be able to discard pairs of diferences <img class="formulaInl" alt="$(da, dc)$" src="form_411.png"/> before they have been fully constructed. This allows to more efficiently constrct a list of valid differentials for the TEA F-function recursively. We use these conditions in <a class="el" href="tea-f-add-pddt_8hh.html#ae8e09fe95cc3eb4257b868d91f8924ec">tea_f_add_pddt_i</a> to discard invalid entries early in the recursion.</p>
<p>To perform the checks, the following relations are used:</p>
<p><img class="formulaInl" alt="$dc = (da \gg R) \Longrightarrow dc \in \{dc_0, dc_1, dc_2, dc_3\}$" src="form_438.png"/> where:</p>
<ul>
<li><img class="formulaInl" alt="$dc_0 = (da \gg R)$" src="form_413.png"/>.</li>
<li><img class="formulaInl" alt="$dc_2 = (da \gg R) - 2^{n-R}$" src="form_414.png"/>.</li>
<li><img class="formulaInl" alt="$dc_1 = (da \gg R) + 1$" src="form_415.png"/>.</li>
<li><img class="formulaInl" alt="$dc_3 = (da \gg R) - 2^{n-R} + 1$" src="form_416.png"/>.</li>
</ul>
<p>Depending on the bit position <img class="formulaInl" alt="$k$" src="form_246.png"/> (some of) the following checks are performed:</p>
<ol type="1">
<li>If <img class="formulaInl" alt="$(k \ge R)$" src="form_417.png"/> perform check on the <img class="formulaInl" alt="$(k-R)$" src="form_418.png"/> LS bits. If <img class="formulaInl" alt="$(k >= R)$" src="form_419.png"/> we check if the first <img class="formulaInl" alt="$(k-R)$" src="form_418.png"/> LSB bits of <img class="formulaInl" alt="$(da \gg R)$" src="form_420.png"/> are equal to the first <img class="formulaInl" alt="$(k-R)$" src="form_418.png"/> bits of <img class="formulaInl" alt="$dc_i,~ 0 \le i < 4$" src="form_439.png"/> according to the above equations. So we check if any of the following four equations hold:<ul>
<li><img class="formulaInl" alt="$(da \gg R)[0:(k - R)] = (dc_0)[0:(k - R)]$" src="form_422.png"/>.</li>
<li><img class="formulaInl" alt="$(da \gg R)[0:(k - R)] = (dc_0 + 2^{n-R})[0:(k - R)]$" src="form_423.png"/>.</li>
<li><img class="formulaInl" alt="$(da \gg R)[0:(k - R)] = (dc_0 - 1)[0:(k - R)]$" src="form_424.png"/>.</li>
<li><img class="formulaInl" alt="$(da \gg R)[0:(k - R)] = (dc_0 + 2^{n-R} - 1)[0:(k - R)]$" src="form_425.png"/>.</li>
</ul>
</li>
<li>Check that the <img class="formulaInl" alt="$R$" src="form_318.png"/> LS bits of <img class="formulaInl" alt="$da$" src="form_405.png"/> are not zero <img class="formulaInl" alt="$da[(r-1):0] \neq 0$" src="form_426.png"/>.</li>
<li>If <img class="formulaInl" alt="$(k >= R) \wedge (k > (n - R))$" src="form_427.png"/> check the <img class="formulaInl" alt="$(n-R)$" src="form_428.png"/> MS bits. When <img class="formulaInl" alt="$(k > (n - R))$" src="form_429.png"/>, <img class="formulaInl" alt="$(da \gg R)[k] = 0$" src="form_430.png"/> and we check the top <img class="formulaInl" alt="$(n-R)$" src="form_428.png"/> MS bits of <img class="formulaInl" alt="$dc$" src="form_406.png"/>. More specifically, we check if the initial four equations hold for the <img class="formulaInl" alt="$(n-R)$" src="form_428.png"/> MS bits of the operands:<ul>
<li><img class="formulaInl" alt="$dc_0[(n-1):(n-R+1)] = (da \gg R)[(n-1):(n-R+1)]$" src="form_431.png"/>.</li>
<li><img class="formulaInl" alt="$dc_1[(n-1):(n-R+1)] = ((da \gg R) + 1)[(n-1):(n-R+1)]$" src="form_432.png"/>.</li>
<li><img class="formulaInl" alt="$dc_2[(n-1):(n-R+1)] = ((da \gg R) - 2^{n-R})[(n-1):(n-R+1)]$" src="form_433.png"/>.</li>
<li><img class="formulaInl" alt="$dc_3[(n-1):(n-R+1)] = ((da \gg R) - 2^{n-R} + 1)[(n-1):(n-R+1)]$" src="form_434.png"/>. </li>
</ul>
</li>
</ol>

</div>
</div>
<a class="anchor" id="af962bfb5724a4f1dd45fdb2fdeac49f4"></a><!-- doxytag: member="tea&#45;f&#45;add&#45;pddt.hh::tea_f_add_pddt" ref="af962bfb5724a4f1dd45fdb2fdeac49f4" args="(uint32_t n, double p_thres, uint32_t lsh_const, uint32_t rsh_const, std::set&lt; differential_t, struct_comp_diff_dx_dy &gt; *diff_set_dx_dy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="tea-f-add-pddt_8hh.html#af962bfb5724a4f1dd45fdb2fdeac49f4">tea_f_add_pddt</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_thres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>lsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>rsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_set_dx_dy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Compute a partial DDT (pDDT) for the TEA F-function: wrapper function of <a class="el" href="tea-f-add-pddt_8hh.html#ae8e09fe95cc3eb4257b868d91f8924ec">tea_f_add_pddt_i</a> . By definition a pDDT contains only differentials that have probability above a fixed probability thershold.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>word size (default is <a class="el" href="common_8hh.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a>). </td></tr>
    <tr><td class="paramname">p_thres</td><td>probability threshold (default is TEA_ADD_P_THRES). </td></tr>
    <tr><td class="paramname">lsh_const</td><td><a class="el" href="common_8hh.html#ab0642bbe3fc1b4488b5fd0e8ea1d1d88">LSH</a> constant (TEA_LSH_CONST). </td></tr>
    <tr><td class="paramname">rsh_const</td><td><a class="el" href="common_8hh.html#aa1542fdafaf6b27d057c000486b42133">RSH</a> constant (TEA_RSH_CONST). </td></tr>
    <tr><td class="paramname">diff_set_dx_dy</td><td>set of differentials <img class="formulaInl" alt="$(dx \rightarrow dy)$" src="form_61.png"/> in the pDDT ordered by index <img class="formulaInl" alt="$i = (dx~ 2^{n} + dy)$" src="form_402.png"/>; stored in an STL set structure, internally implemented as a Red-Black binary search tree.</td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="tea-f-add-pddt_8hh.html#ae8e09fe95cc3eb4257b868d91f8924ec">tea_f_add_pddt_i</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="aa60ac75c659872644ff116ea451bed41"></a><!-- doxytag: member="tea&#45;f&#45;add&#45;pddt.hh::tea_f_add_pddt_adjust_to_key" ref="aa60ac75c659872644ff116ea451bed41" args="(uint32_t nrounds, uint32_t npairs, uint32_t key[4], double p_thres, std::set&lt; differential_t, struct_comp_diff_dx_dy &gt; *diff_set_dx_dy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="tea-f-add-pddt_8hh.html#aa60ac75c659872644ff116ea451bed41">tea_f_add_pddt_adjust_to_key</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nrounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>npairs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>key</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_thres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_set_dx_dy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adjust the probabailities of the differentials in a pDDT computed with <a class="el" href="tea-f-add-pddt_8hh.html#af962bfb5724a4f1dd45fdb2fdeac49f4">tea_f_add_pddt</a> , to the value of a fixed key by performing one-round TEA encryptions over a number of chosen plaintext pairs drawn uniformly at random.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">nrounds</td><td>total number of rounds (NROUNDS). </td></tr>
    <tr><td class="paramname">npairs</td><td>number of chosen plaintext pairs (<a class="el" href="common_8hh.html#ad8bbd29e2946d6b269e0009219061ad6">NPAIRS</a>). </td></tr>
    <tr><td class="paramname">key</td><td>cryptographic key of TEA. </td></tr>
    <tr><td class="paramname">p_thres</td><td>probability threshold (TEA_ADD_P_THRES). </td></tr>
    <tr><td class="paramname">diff_set_dx_dy</td><td>set of differentials (the pDDT) ordered by index <img class="formulaInl" alt="$i = (dx~ 2^{n} + dy)$" src="form_402.png"/> - smallest first. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6334dfbee70edb6980086f15da98f826"></a><!-- doxytag: member="tea&#45;f&#45;add&#45;pddt.hh::tea_f_add_pddt_dxy_to_dp" ref="a6334dfbee70edb6980086f15da98f826" args="(std::multiset&lt; differential_t, struct_comp_diff_p &gt; *diff_mset_p, const std::set&lt; differential_t, struct_comp_diff_dx_dy &gt; diff_set_dx_dy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="tea-f-add-pddt_8hh.html#a6334dfbee70edb6980086f15da98f826">tea_f_add_pddt_dxy_to_dp</a> </td>
          <td>(</td>
          <td class="paramtype">std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_mset_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt;&#160;</td>
          <td class="paramname"><em>diff_set_dx_dy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>From a pDDT represented in the form of a set of differentials ordered by index, compute a pDDT as a set of differentials ordered by probability.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">diff_mset_p</td><td>output pDDT: set of differentials <img class="formulaInl" alt="$(dx \rightarrow dy)$" src="form_61.png"/> ordered by probability; stored in an STL multiset structure, internally implemented as a Red-Black binary search tree. </td></tr>
    <tr><td class="paramname">diff_set_dx_dy</td><td>input pDDT: set of differentials <img class="formulaInl" alt="$(dx \rightarrow dy)$" src="form_61.png"/> ordered by index <img class="formulaInl" alt="$i = (dx~ 2^{n} + dy)$" src="form_402.png"/>; stored in an STL set structure, internally implemented as a Red-Black binary search tree. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad6e23f144fd280b089361de9cad58121"></a><!-- doxytag: member="tea&#45;f&#45;add&#45;pddt.hh::tea_f_add_pddt_exper" ref="ad6e23f144fd280b089361de9cad58121" args="(gsl_matrix *A[2][2][2][2], uint32_t n, double p_thres, uint32_t lsh_const, uint32_t rsh_const, std::multiset&lt; differential_t, struct_comp_diff_p &gt; *diff_mset_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="tea-f-add-pddt_8hh.html#ad6e23f144fd280b089361de9cad58121">tea_f_add_pddt_exper</a> </td>
          <td>(</td>
          <td class="paramtype">gsl_matrix *&#160;</td>
          <td class="paramname"><em>A</em>[2][2][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_thres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>lsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>rsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_mset_p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Experimentally compute the full DDT of the TEA F-function containining expected probabilities, averaged over all keys and round constants. An exhautive search is performed over all input and output differences. <b>Complexity:</b> <img class="formulaInl" alt="$O(2^{2n})$" src="form_23.png"/>.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>transition probability matrices for <img class="formulaInl" alt="$\mathrm{adp}^{3\oplus}$" src="form_8.png"/> (<a class="el" href="adp-xor3_8hh.html#a229a19749624926d15eb5b1731379855">adp_xor3_sf</a>). </td></tr>
    <tr><td class="paramname">n</td><td>word size (default is <a class="el" href="common_8hh.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a>). </td></tr>
    <tr><td class="paramname">p_thres</td><td>probability threshold (default is TEA_ADD_P_THRES). </td></tr>
    <tr><td class="paramname">lsh_const</td><td><a class="el" href="common_8hh.html#ab0642bbe3fc1b4488b5fd0e8ea1d1d88">LSH</a> constant (TEA_LSH_CONST). </td></tr>
    <tr><td class="paramname">rsh_const</td><td><a class="el" href="common_8hh.html#aa1542fdafaf6b27d057c000486b42133">RSH</a> constant (TEA_RSH_CONST). </td></tr>
    <tr><td class="paramname">diff_mset_p</td><td>set of differentials <img class="formulaInl" alt="$(dx \rightarrow dy)$" src="form_61.png"/> ordered by probability (the DDT). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a630bf3eeaef1d61366bfc0ab790f6ab7"></a><!-- doxytag: member="tea&#45;f&#45;add&#45;pddt.hh::tea_f_add_pddt_fk_exper" ref="a630bf3eeaef1d61366bfc0ab790f6ab7" args="(uint32_t n, double p_thres, uint32_t delta, uint32_t k0, uint32_t k1, uint32_t lsh_const, uint32_t rsh_const, std::multiset&lt; differential_t, struct_comp_diff_p &gt; *diff_mset_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="tea-f-add-pddt_8hh.html#a630bf3eeaef1d61366bfc0ab790f6ab7">tea_f_add_pddt_fk_exper</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_thres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>k0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>k1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>lsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>rsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_mset_p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Experimentally compute the full DDT of the TEA F-function containining probabilities for a fixed key and round constant. An exhautive search is performed over all input and output differences. <b>Complexity:</b> <img class="formulaInl" alt="$O(2^{2n})$" src="form_23.png"/>.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>word size (default is <a class="el" href="common_8hh.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a>). </td></tr>
    <tr><td class="paramname">p_thres</td><td>probability threshold (default is TEA_ADD_P_THRES). </td></tr>
    <tr><td class="paramname">delta</td><td>round constant. </td></tr>
    <tr><td class="paramname">k0</td><td>first round key. </td></tr>
    <tr><td class="paramname">k1</td><td>second round key. </td></tr>
    <tr><td class="paramname">lsh_const</td><td><a class="el" href="common_8hh.html#ab0642bbe3fc1b4488b5fd0e8ea1d1d88">LSH</a> constant (TEA_LSH_CONST). </td></tr>
    <tr><td class="paramname">rsh_const</td><td><a class="el" href="common_8hh.html#aa1542fdafaf6b27d057c000486b42133">RSH</a> constant (TEA_RSH_CONST). </td></tr>
    <tr><td class="paramname">diff_mset_p</td><td>set of differentials <img class="formulaInl" alt="$(dx \rightarrow dy)$" src="form_61.png"/> ordered by probability (the DDT). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae8e09fe95cc3eb4257b868d91f8924ec"></a><!-- doxytag: member="tea&#45;f&#45;add&#45;pddt.hh::tea_f_add_pddt_i" ref="ae8e09fe95cc3eb4257b868d91f8924ec" args="(const uint32_t k, const uint32_t n, const uint32_t lsh_const, const uint32_t rsh_const, gsl_matrix *A[2][2][2][2], gsl_vector *C, uint32_t *da, uint32_t *db, uint32_t *dc, uint32_t *dd, double *p, const double p_thres, std::set&lt; differential_t, struct_comp_diff_dx_dy &gt; *diff_set_dx_dy)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="tea-f-add-pddt_8hh.html#ae8e09fe95cc3eb4257b868d91f8924ec">tea_f_add_pddt_i</a> </td>
          <td>(</td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>lsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>rsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_matrix *&#160;</td>
          <td class="paramname"><em>A</em>[2][2][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gsl_vector *&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>da</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>dc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>dd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>p_thres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_set_dx_dy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Computes a partial difference distribution table (pDDT) for the F-function of block cipher TEA.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>current bit position in the recursion. </td></tr>
    <tr><td class="paramname">n</td><td>word size (default is <a class="el" href="common_8hh.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a>). </td></tr>
    <tr><td class="paramname">lsh_const</td><td><a class="el" href="common_8hh.html#ab0642bbe3fc1b4488b5fd0e8ea1d1d88">LSH</a> constant (default is 4). </td></tr>
    <tr><td class="paramname">rsh_const</td><td><a class="el" href="common_8hh.html#aa1542fdafaf6b27d057c000486b42133">RSH</a> constant (default is 5). </td></tr>
    <tr><td class="paramname">A</td><td>transition probability matrices for <img class="formulaInl" alt="$\mathrm{adp}^{3\oplus}$" src="form_8.png"/> (<a class="el" href="adp-xor3_8hh.html#a229a19749624926d15eb5b1731379855">adp_xor3_sf</a>). </td></tr>
    <tr><td class="paramname">C</td><td>unit column vector for computing <img class="formulaInl" alt="$ \mathrm{adp}^{3\oplus}$" src="form_453.png"/> (<a class="el" href="adp-xor3_8hh.html#a980a22f6faf155e031f0d9f7e8ca9361">adp_xor3</a>). </td></tr>
    <tr><td class="paramname">da</td><td>first input difference to the XOR operation in F. </td></tr>
    <tr><td class="paramname">db</td><td>second input difference to the XOR operation in F. </td></tr>
    <tr><td class="paramname">dc</td><td>third input difference to the XOR operation in F. </td></tr>
    <tr><td class="paramname">dd</td><td>output difference from the XOR operation in F. </td></tr>
    <tr><td class="paramname">p</td><td>probability of the partially constructed differential <img class="formulaInl" alt="$(da[k:0], db[k:0], dc[k:0] \rightarrow dd[k:0])$" src="form_202.png"/>. </td></tr>
    <tr><td class="paramname">p_thres</td><td>probability threshold (default is TEA_ADD_P_THRES). </td></tr>
    <tr><td class="paramname">diff_set_dx_dy</td><td>set of differentials <img class="formulaInl" alt="$(dx \rightarrow dy)$" src="form_61.png"/> in the pDDT ordered by index <img class="formulaInl" alt="$i = (dx~ 2^{n} + dy)$" src="form_402.png"/>; stored in an STL set structure, internally implemented as a Red-Black binary search tree.</td></tr>
  </table>
  </dd>
</dl>
<dl class="attention"><dt><b>Attention:</b></dt><dd>The computed pDDT is based on the expected additive differential probability of the TEA F-function (<a class="el" href="eadp-tea-f_8hh.html#a2b46cad5e0dd22f116160ef8fde6e15f">eadp_tea_f</a>), averaged over all round keys and round constants <img class="formulaInl" alt="$\delta$" src="form_19.png"/> and therefore contains average (as opposed to fixed-key fixed-constants <a class="el" href="adp-tea-f-fk_8hh.html#a197140aa874649bb8dc119db47f6b139">adp_f_fk</a>) probabilities.</dd></dl>
<p><b>Algorithm</b> <b>Outline:</b> </p>
<p>Applies conceptually the same logic as <a class="el" href="adp-xor-pddt_8hh.html#a390612775ec87908fbb044d375ff9010">adp_xor_pddt_i</a>. It recursively constructs all differentials for the XOR operation with three inputs <img class="formulaInl" alt="$(da, db, dc \rightarrow dd)$" src="form_447.png"/>, with the additional requirement that they must satisfy the following properties:</p>
<ol type="1">
<li><img class="formulaInl" alt="$\mathrm{adp}^{3\oplus}(da, db, dc \rightarrow dd) > p_\mathrm{thres}$" src="form_448.png"/>.</li>
<li><img class="formulaInl" alt="$db = da \ll 4$" src="form_449.png"/>.</li>
<li><img class="formulaInl" alt="$dc \in {(da \ll R), (da \ll R) + 1, (da \ll R) - 2^{n-R}, (da \ll R) - 2^{n-R} + 1}$" src="form_455.png"/>, so that <img class="formulaInl" alt="$dc = (da \ll R)$" src="form_456.png"/> where <img class="formulaInl" alt="$R =$" src="form_458.png"/>TEA_RSH_CONST.</li>
</ol>
<p>Only the entries for which <img class="formulaInl" alt="$\mathrm{eadp}^{F}(da \rightarrow dd) > p_\mathrm{thres}$" src="form_454.png"/> are stored.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="adp-xor-pddt_8hh.html#a390612775ec87908fbb044d375ff9010">adp_xor_pddt_i</a>, <a class="el" href="tea-f-add-pddt_8hh.html#a55f531edb6fd0ce85c20b47e890475e3">lsh_condition_is_sat</a>, <a class="el" href="tea-f-add-pddt_8hh.html#a9a9b0ca87b727a966ffb1842ffa389e3">rsh_condition_is_sat</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="a379d6e4054b1bf78e6068f4cbdd06065"></a><!-- doxytag: member="tea&#45;f&#45;add&#45;pddt.hh::tea_f_da_add_pddt" ref="a379d6e4054b1bf78e6068f4cbdd06065" args="(uint32_t n, double p_thres, uint32_t lsh_const, uint32_t rsh_const, const uint32_t da, const uint32_t da_prev, std::set&lt; differential_t, struct_comp_diff_dx_dy &gt; *hways_diff_set_dx_dy, std::multiset&lt; differential_t, struct_comp_diff_p &gt; *hways_diff_mset_p, std::set&lt; differential_t, struct_comp_diff_dx_dy &gt; *diff_set_dx_dy, std::multiset&lt; differential_t, struct_comp_diff_p &gt; *diff_mset_p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="tea-f-add-pddt_8hh.html#a379d6e4054b1bf78e6068f4cbdd06065">tea_f_da_add_pddt</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_thres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>lsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>rsh_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>da</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>da_prev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *&#160;</td>
          <td class="paramname"><em>hways_diff_set_dx_dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *&#160;</td>
          <td class="paramname"><em>hways_diff_mset_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__dx__dy.html">struct_comp_diff_dx_dy</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_set_dx_dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::multiset&lt; <a class="el" href="structdifferential__t.html">differential_t</a>, <a class="el" href="structstruct__comp__diff__p.html">struct_comp_diff_p</a> &gt; *&#160;</td>
          <td class="paramname"><em>diff_mset_p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Wrapper for <a class="el" href="tea-f-add-pddt_8cc.html#a8139a197e7fe5a69368a2746bc4e6ca5">tea_f_da_db_dc_add_pddt_i</a> . Returns the number of new entries that were added .</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>word size (default is <a class="el" href="common_8hh.html#a92ed8507d1cd2331ad09275c5c4c1c89">WORD_SIZE</a>). </td></tr>
    <tr><td class="paramname">p_thres</td><td>probability threshold (default is TEA_ADD_P_THRES). </td></tr>
    <tr><td class="paramname">lsh_const</td><td><a class="el" href="common_8hh.html#ab0642bbe3fc1b4488b5fd0e8ea1d1d88">LSH</a> constant (default is TEA_LSH_CONST). </td></tr>
    <tr><td class="paramname">rsh_const</td><td><a class="el" href="common_8hh.html#aa1542fdafaf6b27d057c000486b42133">RSH</a> constant (default is TEA_RSH_CONST). </td></tr>
    <tr><td class="paramname">da</td><td>input difference to F. </td></tr>
    <tr><td class="paramname">da_prev</td><td>input difference to the previous round. </td></tr>
    <tr><td class="paramname">hways_diff_set_dx_dy</td><td>set of differentials <img class="formulaInl" alt="$(dx,dy,p)$" src="form_391.png"/> (Highways) ordered by index <img class="formulaInl" alt="$i = (dx~ 2^{n} + dy)$" src="form_402.png"/>. </td></tr>
    <tr><td class="paramname">hways_diff_mset_p</td><td>set of differentials <img class="formulaInl" alt="$(dx,dy,p)$" src="form_391.png"/> (Highways) ordered by probability p. </td></tr>
    <tr><td class="paramname">diff_set_dx_dy</td><td>set of differentials <img class="formulaInl" alt="$(dx,dy,p)$" src="form_391.png"/> (Countryroads) ordered by index <img class="formulaInl" alt="$i = (dx~ 2^{n} + dy)$" src="form_402.png"/>. </td></tr>
    <tr><td class="paramname">diff_mset_p</td><td>temporrary set of differentials <img class="formulaInl" alt="$(dx,dy,p)$" src="form_391.png"/> (Countryroads) ordered by probability p. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of output differences that were added to <code>diff_set_dx_dy</code> . </dd></dl>

</div>
</div>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="tea-f-add-pddt_8hh.html">tea-f-add-pddt.hh</a>      </li>

    <li class="footer">Generated on Sun Jun 9 2013 14:53:05 for YAARX: Yet Another ARX Toolkit by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
