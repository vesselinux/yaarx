\hypertarget{xtea-add-threshold-search_8cc}{\subsection{src/xtea-\/add-\/threshold-\/search.cc \-File \-Reference}
\label{xtea-add-threshold-search_8cc}\index{src/xtea-\/add-\/threshold-\/search.\-cc@{src/xtea-\/add-\/threshold-\/search.\-cc}}
}


\-Automatic search for \-A\-D\-D differential trails in block cipher \-X\-T\-E\-A.  


{\ttfamily \#include \char`\"{}common.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}adp-\/xor.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}max-\/adp-\/xor.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}adp-\/xor-\/fi.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}max-\/adp-\/xor-\/fi.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}adp-\/shift.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}xtea.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}adp-\/xtea-\/f-\/fk.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}xtea-\/f-\/add-\/pddt.\-hh\char`\"{}}\*
\subsubsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{xtea-add-threshold-search_8cc_a18a7f48b1b44dcf0c408b2988cec4cf5}{xtea\-\_\-add\-\_\-threshold\-\_\-search} (const int n, const int nrounds, const uint32\-\_\-t npairs, const uint32\-\_\-t round\-\_\-key\mbox{[}64\mbox{]}, const uint32\-\_\-t round\-\_\-delta\mbox{[}64\mbox{]}, gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-matrix $\ast$\-A\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, double \-B\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]}, double $\ast$\-Bn, const \hyperlink{structdifferential__t}{differential\-\_\-t} diff\-\_\-in\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]}, \hyperlink{structdifferential__t}{differential\-\_\-t} trail\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]}, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const, std\-::multiset$<$ \hyperlink{structdifferential__t}{differential\-\_\-t}, \hyperlink{structstruct__comp__diff__p}{struct\-\_\-comp\-\_\-diff\-\_\-p} $>$ $\ast$diff\-\_\-mset\-\_\-p, std\-::set$<$ \hyperlink{structdifferential__t}{differential\-\_\-t}, \hyperlink{structstruct__comp__diff__dx__dy}{struct\-\_\-comp\-\_\-diff\-\_\-dx\-\_\-dy} $>$ $\ast$diff\-\_\-set\-\_\-dx\-\_\-dy)
\item 
void \hyperlink{xtea-add-threshold-search_8cc_a3fcd1eac7ae4338a32e79d7301c1fab0}{xtea\-\_\-add\-\_\-trail\-\_\-search} (uint32\-\_\-t key\mbox{[}4\mbox{]}, uint32\-\_\-t round\-\_\-key\mbox{[}64\mbox{]}, uint32\-\_\-t round\-\_\-delta\mbox{[}64\mbox{]})
\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-Automatic search for \-A\-D\-D differential trails in block cipher \-X\-T\-E\-A. \begin{DoxyAuthor}{\-Author}
\-V.\-Velichkov, \href{mailto:vesselin.velichkov@uni.lu}{\tt vesselin.\-velichkov@uni.\-lu} 
\end{DoxyAuthor}


\subsubsection{\-Function \-Documentation}
\hypertarget{xtea-add-threshold-search_8cc_a18a7f48b1b44dcf0c408b2988cec4cf5}{\index{xtea-\/add-\/threshold-\/search.\-cc@{xtea-\/add-\/threshold-\/search.\-cc}!xtea\-\_\-add\-\_\-threshold\-\_\-search@{xtea\-\_\-add\-\_\-threshold\-\_\-search}}
\index{xtea\-\_\-add\-\_\-threshold\-\_\-search@{xtea\-\_\-add\-\_\-threshold\-\_\-search}!xtea-add-threshold-search.cc@{xtea-\/add-\/threshold-\/search.\-cc}}
\paragraph[{xtea\-\_\-add\-\_\-threshold\-\_\-search}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf xtea\-\_\-add\-\_\-threshold\-\_\-search} (
\begin{DoxyParamCaption}
\item[{const int}]{n, }
\item[{const int}]{nrounds, }
\item[{const uint32\-\_\-t}]{npairs, }
\item[{const uint32\-\_\-t}]{round\-\_\-key\mbox{[}64\mbox{]}, }
\item[{const uint32\-\_\-t}]{round\-\_\-delta\mbox{[}64\mbox{]}, }
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-matrix $\ast$}]{\-A\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{double}]{\-B\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]}, }
\item[{double $\ast$}]{\-Bn, }
\item[{const {\bf differential\-\_\-t}}]{diff\-\_\-in\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]}, }
\item[{{\bf differential\-\_\-t}}]{trail\mbox{[}\-N\-R\-O\-U\-N\-D\-S\mbox{]}, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{std\-::multiset$<$ {\bf differential\-\_\-t}, {\bf struct\-\_\-comp\-\_\-diff\-\_\-p} $>$ $\ast$}]{diff\-\_\-mset\-\_\-p, }
\item[{std\-::set$<$ {\bf differential\-\_\-t}, {\bf struct\-\_\-comp\-\_\-diff\-\_\-dx\-\_\-dy} $>$ $\ast$}]{diff\-\_\-set\-\_\-dx\-\_\-dy}
\end{DoxyParamCaption}
)}}\label{xtea-add-threshold-search_8cc_a18a7f48b1b44dcf0c408b2988cec4cf5}
\-Automatic search for \-A\-D\-D differential trails in block cipher \-X\-T\-E\-A using p\-D\-D\-T.

\begin{DoxyNote}{\-Note}
\-For more details on the algorithm see \hyperlink{tea-add-threshold-search_8cc_ab59db616cde68bf9245c7d24c98e3a6c}{tea\-\_\-add\-\_\-threshold\-\_\-search}.
\end{DoxyNote}

\begin{DoxyParams}{\-Parameters}
{\em n} & index of the current round\-: $0 \le n < \mathrm{nrounds}$. \\
\hline
{\em nrounds} & total number of rounds (\-N\-R\-O\-U\-N\-D\-S). \\
\hline
{\em npairs} & number of chosen plaintext pairs (\hyperlink{common_8hh_ad8bbd29e2946d6b269e0009219061ad6}{\-N\-P\-A\-I\-R\-S}). \\
\hline
{\em round\-\_\-key} & all round keys for the full \-X\-T\-E\-A. \\
\hline
{\em round\-\_\-delta} & all round constants for the full \-X\-T\-E\-A. \\
\hline
{\em \-A} & transition probability matrices for $\mathrm{adp}^{\oplus}$ (\hyperlink{adp-xor_8hh_a42dda78d01cbb1a68263d971c1ab63ea}{adp\-\_\-xor\-\_\-sf}). \\
\hline
{\em \-A\-A} & transition probability matrices for \-X\-O\-R with fixed input $\mathrm{adp}^{\oplus}_{\mathrm{FI}}$ (\hyperlink{adp-xor-fi_8hh_a37c75fcba5d5904b75461ab35ff8d80d}{adp\-\_\-xor\-\_\-fixed\-\_\-input\-\_\-sf}). \\
\hline
{\em \-B} & array containing the best differential probabilities for i rounds\-: $0 \le i < n$. \\
\hline
{\em \-Bn} & the best found probability on $n$ rounds, updated dynamically. \\
\hline
{\em diff\-\_\-in} & array of differentials. \\
\hline
{\em trail} & best found differential trail for {\ttfamily nrounds}. \\
\hline
{\em lsh\-\_\-const} & \-L\-S\-H constant (\-T\-E\-A\-\_\-\-L\-S\-H\-\_\-\-C\-O\-N\-S\-T). \\
\hline
{\em rsh\-\_\-const} & \-R\-S\-H constant (\-T\-E\-A\-\_\-\-R\-S\-H\-\_\-\-C\-O\-N\-S\-T). \\
\hline
{\em diff\-\_\-mset\-\_\-p} & set of differentials $(dx,dy,p)$ (the p\-D\-D\-T) ordered by probability p. \\
\hline
{\em diff\-\_\-set\-\_\-dx\-\_\-dy} & set of differentials $(dx,dy,p)$ (the p\-D\-D\-T) ordered by index $i = (dx~ 2^{n} + dy)$.\\
\hline
\end{DoxyParams}
\-The outline of the array of bounds $B$ is the following\-:


\begin{DoxyItemize}
\item $B[0]$\-: best probability for $1$ round.
\item $B[1]$\-: best probability for $2$ rounds.
\item $\ldots$
\item $B[i]$\-: best probability for $(i+1)$ rounds.
\item $\ldots$
\item $B[n-2]$\-: best probability for $(n-1)$ rounds.
\item $B[n-1]$\-: best probability for $n$ rounds.
\end{DoxyItemize}

\begin{DoxySeeAlso}{\-See also}
\hyperlink{tea-add-threshold-search_8cc_ab59db616cde68bf9245c7d24c98e3a6c}{tea\-\_\-add\-\_\-threshold\-\_\-search}. 
\end{DoxySeeAlso}
\hypertarget{xtea-add-threshold-search_8cc_a3fcd1eac7ae4338a32e79d7301c1fab0}{\index{xtea-\/add-\/threshold-\/search.\-cc@{xtea-\/add-\/threshold-\/search.\-cc}!xtea\-\_\-add\-\_\-trail\-\_\-search@{xtea\-\_\-add\-\_\-trail\-\_\-search}}
\index{xtea\-\_\-add\-\_\-trail\-\_\-search@{xtea\-\_\-add\-\_\-trail\-\_\-search}!xtea-add-threshold-search.cc@{xtea-\/add-\/threshold-\/search.\-cc}}
\paragraph[{xtea\-\_\-add\-\_\-trail\-\_\-search}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf xtea\-\_\-add\-\_\-trail\-\_\-search} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t}]{key\mbox{[}4\mbox{]}, }
\item[{uint32\-\_\-t}]{round\-\_\-key\mbox{[}64\mbox{]}, }
\item[{uint32\-\_\-t}]{round\-\_\-delta\mbox{[}64\mbox{]}}
\end{DoxyParamCaption}
)}}\label{xtea-add-threshold-search_8cc_a3fcd1eac7ae4338a32e79d7301c1fab0}
\-Search for \-A\-D\-D differential trails in block cipher \-X\-T\-E\-A\-: wrapper function for \hyperlink{tea-add-threshold-search_8cc_ab59db616cde68bf9245c7d24c98e3a6c}{tea\-\_\-add\-\_\-threshold\-\_\-search}.


\begin{DoxyParams}{\-Parameters}
{\em key} & cryptographic key of \-X\-T\-E\-A. \\
\hline
{\em round\-\_\-key} & all round keys for the full \-X\-T\-E\-A. \\
\hline
{\em round\-\_\-delta} & all round constants for the full \-X\-T\-E\-A.\\
\hline
\end{DoxyParams}
{\bfseries \-Algorithm} {\bfseries \-Outline\-:} 

\-The procedure operates as follows\-:


\begin{DoxyEnumerate}
\item \-Compute a p\-D\-D\-T for \-F (\hyperlink{xtea-f-add-pddt_8hh_a98d696f2047ccb8b1a07f777a55a1168}{xtea\-\_\-f\-\_\-add\-\_\-pddt}).
\item \-Adjust the probabilities of the p\-D\-D\-T to the round key and constant (\hyperlink{adp-xtea-f-fk_8hh_a07bf299450a988931eb46ec5cca05150}{adp\-\_\-xtea\-\_\-f\-\_\-approx}).
\item \-Execute the search for differential trails for $n$ rounds (n = \-N\-R\-O\-U\-N\-D\-S) through a successive application of \hyperlink{xtea-add-threshold-search_8hh_a18a7f48b1b44dcf0c408b2988cec4cf5}{xtea\-\_\-add\-\_\-threshold\-\_\-search} \-:
\begin{DoxyItemize}
\item \-Compute the best found probability on 1 round\-: $B[0]$.
\item \-Using $B[0]$ compute the best found probability on 2 rounds\-: $B[1]$.
\item $\ldots$
\item \-Using $B[0],\ldots,B[i-1]$ compute the best found probability on $(i+1)$ rounds\-: $B[i]$.
\item $\ldots$
\item \-Using $B[0],\ldots,B[n-2]$ compute the best found probability on $n$ rounds\-: $B[n-1]$.
\end{DoxyItemize}
\item \-Print the best found trail on $n$ rounds on standrad output and terminate.
\end{DoxyEnumerate}

\begin{DoxySeeAlso}{\-See also}
\hyperlink{xtea-add-threshold-search_8hh_a18a7f48b1b44dcf0c408b2988cec4cf5}{xtea\-\_\-add\-\_\-threshold\-\_\-search}, \hyperlink{tea-add-threshold-search_8hh_aa0f68e80d4599027b9a5c581891af32f}{tea\-\_\-add\-\_\-trail\-\_\-search} 
\end{DoxySeeAlso}
