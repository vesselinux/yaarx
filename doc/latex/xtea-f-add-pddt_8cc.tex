\hypertarget{xtea-f-add-pddt_8cc}{\subsection{src/xtea-\/f-\/add-\/pddt.cc \-File \-Reference}
\label{xtea-f-add-pddt_8cc}\index{src/xtea-\/f-\/add-\/pddt.\-cc@{src/xtea-\/f-\/add-\/pddt.\-cc}}
}


\-Computing an \-A\-D\-D partial difference distribution table (p\-D\-D\-T) for the \-F-\/function of block cipher \-X\-T\-E\-A.  


{\ttfamily \#include \char`\"{}common.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}adp-\/xor.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}max-\/adp-\/xor.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}max-\/adp-\/xor-\/fi.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}adp-\/shift.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}tea-\/f-\/add-\/pddt.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}xtea.\-hh\char`\"{}}\*
{\ttfamily \#include \char`\"{}adp-\/xtea-\/f-\/fk.\-hh\char`\"{}}\*
\subsubsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{xtea-f-add-pddt_8cc_a6dded7b175a5f072d48becf43f3c9db1}{xtea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-i} (const uint32\-\_\-t k, const uint32\-\_\-t n, const uint32\-\_\-t key, const uint32\-\_\-t delta, const uint32\-\_\-t lsh\-\_\-const, const uint32\-\_\-t rsh\-\_\-const, gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-matrix $\ast$\-A\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-vector $\ast$\-C, uint32\-\_\-t $\ast$da, uint32\-\_\-t $\ast$db, uint32\-\_\-t $\ast$dc, uint32\-\_\-t $\ast$dd, double $\ast$p, const double p\-\_\-thres, std\-::set$<$ \hyperlink{structdifferential__t}{differential\-\_\-t}, \hyperlink{structstruct__comp__diff__dx__dy}{struct\-\_\-comp\-\_\-diff\-\_\-dx\-\_\-dy} $>$ $\ast$diff\-\_\-set\-\_\-dx\-\_\-dy)
\item 
void \hyperlink{xtea-f-add-pddt_8cc_a98d696f2047ccb8b1a07f777a55a1168}{xtea\-\_\-f\-\_\-add\-\_\-pddt} (uint32\-\_\-t n, double p\-\_\-thres, uint32\-\_\-t lsh\-\_\-const, uint32\-\_\-t rsh\-\_\-const, gsl\-\_\-matrix $\ast$\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-matrix $\ast$\-A\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, gsl\-\_\-vector $\ast$\-C, uint32\-\_\-t key, uint32\-\_\-t delta, std\-::set$<$ \hyperlink{structdifferential__t}{differential\-\_\-t}, \hyperlink{structstruct__comp__diff__dx__dy}{struct\-\_\-comp\-\_\-diff\-\_\-dx\-\_\-dy} $>$ $\ast$diff\-\_\-set\-\_\-dx\-\_\-dy)
\item 
void \hyperlink{xtea-f-add-pddt_8cc_a84e14ae4c2be82a4895dfa91f012e9e3}{xtea\-\_\-add\-\_\-pddt\-\_\-dxy\-\_\-to\-\_\-dp} (std\-::multiset$<$ \hyperlink{structdifferential__t}{differential\-\_\-t}, \hyperlink{structstruct__comp__diff__p}{struct\-\_\-comp\-\_\-diff\-\_\-p} $>$ $\ast$diff\-\_\-mset\-\_\-p, const std\-::set$<$ \hyperlink{structdifferential__t}{differential\-\_\-t}, \hyperlink{structstruct__comp__diff__dx__dy}{struct\-\_\-comp\-\_\-diff\-\_\-dx\-\_\-dy} $>$ diff\-\_\-set\-\_\-dx\-\_\-dy)
\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-Computing an \-A\-D\-D partial difference distribution table (p\-D\-D\-T) for the \-F-\/function of block cipher \-X\-T\-E\-A. \begin{DoxyAuthor}{\-Author}
\-V.\-Velichkov, \href{mailto:vesselin.velichkov@uni.lu}{\tt vesselin.\-velichkov@uni.\-lu} 
\end{DoxyAuthor}
\begin{DoxyDate}{\-Date}
2012-\/2013 
\end{DoxyDate}


\subsubsection{\-Function \-Documentation}
\hypertarget{xtea-f-add-pddt_8cc_a84e14ae4c2be82a4895dfa91f012e9e3}{\index{xtea-\/f-\/add-\/pddt.\-cc@{xtea-\/f-\/add-\/pddt.\-cc}!xtea\-\_\-add\-\_\-pddt\-\_\-dxy\-\_\-to\-\_\-dp@{xtea\-\_\-add\-\_\-pddt\-\_\-dxy\-\_\-to\-\_\-dp}}
\index{xtea\-\_\-add\-\_\-pddt\-\_\-dxy\-\_\-to\-\_\-dp@{xtea\-\_\-add\-\_\-pddt\-\_\-dxy\-\_\-to\-\_\-dp}!xtea-f-add-pddt.cc@{xtea-\/f-\/add-\/pddt.\-cc}}
\paragraph[{xtea\-\_\-add\-\_\-pddt\-\_\-dxy\-\_\-to\-\_\-dp}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf xtea\-\_\-add\-\_\-pddt\-\_\-dxy\-\_\-to\-\_\-dp} (
\begin{DoxyParamCaption}
\item[{std\-::multiset$<$ {\bf differential\-\_\-t}, {\bf struct\-\_\-comp\-\_\-diff\-\_\-p} $>$ $\ast$}]{diff\-\_\-mset\-\_\-p, }
\item[{const std\-::set$<$ {\bf differential\-\_\-t}, {\bf struct\-\_\-comp\-\_\-diff\-\_\-dx\-\_\-dy} $>$}]{diff\-\_\-set\-\_\-dx\-\_\-dy}
\end{DoxyParamCaption}
)}}\label{xtea-f-add-pddt_8cc_a84e14ae4c2be82a4895dfa91f012e9e3}
\-From a p\-D\-D\-T represented in the from of a set of differentials ordered by index, compute a p\-D\-D\-T as a set of differentials ordered by probability.


\begin{DoxyParams}{\-Parameters}
{\em diff\-\_\-mset\-\_\-p} & output p\-D\-D\-T\-: set of differentials $(dx \rightarrow dy)$ ordered by probability; stored in an \-S\-T\-L multiset structure, internally implemented as a \-Red-\/\-Black binary search tree. \\
\hline
{\em diff\-\_\-set\-\_\-dx\-\_\-dy} & input p\-D\-D\-T\-: set of differentials $(dx \rightarrow dy)$ ordered by index $i = (dx~ 2^{n} + dy)$; stored in an \-S\-T\-L set structure, internally implemented as a \-Red-\/\-Black binary search tree.\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{tea-f-add-pddt_8hh_a6334dfbee70edb6980086f15da98f826}{tea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-dxy\-\_\-to\-\_\-dp} 
\end{DoxySeeAlso}
\hypertarget{xtea-f-add-pddt_8cc_a98d696f2047ccb8b1a07f777a55a1168}{\index{xtea-\/f-\/add-\/pddt.\-cc@{xtea-\/f-\/add-\/pddt.\-cc}!xtea\-\_\-f\-\_\-add\-\_\-pddt@{xtea\-\_\-f\-\_\-add\-\_\-pddt}}
\index{xtea\-\_\-f\-\_\-add\-\_\-pddt@{xtea\-\_\-f\-\_\-add\-\_\-pddt}!xtea-f-add-pddt.cc@{xtea-\/f-\/add-\/pddt.\-cc}}
\paragraph[{xtea\-\_\-f\-\_\-add\-\_\-pddt}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf xtea\-\_\-f\-\_\-add\-\_\-pddt} (
\begin{DoxyParamCaption}
\item[{uint32\-\_\-t}]{n, }
\item[{double}]{p\-\_\-thres, }
\item[{uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-matrix $\ast$}]{\-A\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-vector $\ast$}]{\-C, }
\item[{uint32\-\_\-t}]{key, }
\item[{uint32\-\_\-t}]{delta, }
\item[{std\-::set$<$ {\bf differential\-\_\-t}, {\bf struct\-\_\-comp\-\_\-diff\-\_\-dx\-\_\-dy} $>$ $\ast$}]{diff\-\_\-set\-\_\-dx\-\_\-dy}
\end{DoxyParamCaption}
)}}\label{xtea-f-add-pddt_8cc_a98d696f2047ccb8b1a07f777a55a1168}
\-Compute a partial \-D\-D\-T (p\-D\-D\-T) for the \-X\-T\-E\-A \-F-\/function\-: wrapper function of \hyperlink{xtea-f-add-pddt_8hh_a6dded7b175a5f072d48becf43f3c9db1}{xtea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-i} . \-By definition a p\-D\-D\-T contains only differentials that have probability above a fixed probability thershold.


\begin{DoxyParams}{\-Parameters}
{\em n} & word size (default is \hyperlink{common_8hh_a92ed8507d1cd2331ad09275c5c4c1c89}{\-W\-O\-R\-D\-\_\-\-S\-I\-Z\-E}). \\
\hline
{\em p\-\_\-thres} & probability threshold (default is \hyperlink{xtea_8hh_a33552d767f63f3e835002cbd0bfe52c4}{\-X\-T\-E\-A\-\_\-\-A\-D\-D\-\_\-\-P\-\_\-\-T\-H\-R\-E\-S}). \\
\hline
{\em lsh\-\_\-const} & \hyperlink{common_8hh_ab0642bbe3fc1b4488b5fd0e8ea1d1d88}{\-L\-S\-H} constant (\-T\-E\-A\-\_\-\-L\-S\-H\-\_\-\-C\-O\-N\-S\-T). \\
\hline
{\em rsh\-\_\-const} & \hyperlink{common_8hh_aa1542fdafaf6b27d057c000486b42133}{\-R\-S\-H} constant (\-T\-E\-A\-\_\-\-R\-S\-H\-\_\-\-C\-O\-N\-S\-T). \\
\hline
{\em \-A} & transition probability matrices for $\mathrm{adp}^{\oplus}$ (\hyperlink{adp-xor_8hh_a42dda78d01cbb1a68263d971c1ab63ea}{adp\-\_\-xor\-\_\-sf}). \\
\hline
{\em \-A\-A} & transition probability matrices for \-X\-O\-R with fixed input $\mathrm{adp}^{\oplus}_{\mathrm{FI}}$ (\hyperlink{adp-xor-fi_8hh_a37c75fcba5d5904b75461ab35ff8d80d}{adp\-\_\-xor\-\_\-fixed\-\_\-input\-\_\-sf}). \\
\hline
{\em \-C} & unit column vector for computing $ \mathrm{adp}^{\oplus}$ (\hyperlink{adp-xor_8hh_ac720722a292fc8bb277b751e0b0be072}{adp\-\_\-xor}). \\
\hline
{\em key} & round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em diff\-\_\-set\-\_\-dx\-\_\-dy} & set of differentials $(dx \rightarrow dy)$ in the p\-D\-D\-T ordered by index $i = (dx~ 2^{n} + dy)$; stored in an \-S\-T\-L set structure, internally implemented as a \-Red-\/\-Black binary search tree.\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{\-See also}
\hyperlink{tea-f-add-pddt_8hh_ae8e09fe95cc3eb4257b868d91f8924ec}{tea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-i}. 
\end{DoxySeeAlso}
\hypertarget{xtea-f-add-pddt_8cc_a6dded7b175a5f072d48becf43f3c9db1}{\index{xtea-\/f-\/add-\/pddt.\-cc@{xtea-\/f-\/add-\/pddt.\-cc}!xtea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-i@{xtea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-i}}
\index{xtea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-i@{xtea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-i}!xtea-f-add-pddt.cc@{xtea-\/f-\/add-\/pddt.\-cc}}
\paragraph[{xtea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-i}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf xtea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-i} (
\begin{DoxyParamCaption}
\item[{const uint32\-\_\-t}]{k, }
\item[{const uint32\-\_\-t}]{n, }
\item[{const uint32\-\_\-t}]{key, }
\item[{const uint32\-\_\-t}]{delta, }
\item[{const uint32\-\_\-t}]{lsh\-\_\-const, }
\item[{const uint32\-\_\-t}]{rsh\-\_\-const, }
\item[{gsl\-\_\-matrix $\ast$}]{\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-matrix $\ast$}]{\-A\-A\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}\mbox{[}2\mbox{]}, }
\item[{gsl\-\_\-vector $\ast$}]{\-C, }
\item[{uint32\-\_\-t $\ast$}]{da, }
\item[{uint32\-\_\-t $\ast$}]{db, }
\item[{uint32\-\_\-t $\ast$}]{dc, }
\item[{uint32\-\_\-t $\ast$}]{dd, }
\item[{double $\ast$}]{p, }
\item[{const double}]{p\-\_\-thres, }
\item[{std\-::set$<$ {\bf differential\-\_\-t}, {\bf struct\-\_\-comp\-\_\-diff\-\_\-dx\-\_\-dy} $>$ $\ast$}]{diff\-\_\-set\-\_\-dx\-\_\-dy}
\end{DoxyParamCaption}
)}}\label{xtea-f-add-pddt_8cc_a6dded7b175a5f072d48becf43f3c9db1}
\-Computes an \-A\-D\-D partial difference distribution table (p\-D\-D\-T) for the \-F-\/function of block cipher \-T\-E\-A.


\begin{DoxyParams}{\-Parameters}
{\em k} & current bit position in the recursion. \\
\hline
{\em n} & word size (default is \hyperlink{common_8hh_a92ed8507d1cd2331ad09275c5c4c1c89}{\-W\-O\-R\-D\-\_\-\-S\-I\-Z\-E}). \\
\hline
{\em key} & round key. \\
\hline
{\em delta} & round constant. \\
\hline
{\em lsh\-\_\-const} & \hyperlink{common_8hh_ab0642bbe3fc1b4488b5fd0e8ea1d1d88}{\-L\-S\-H} constant (\-T\-E\-A\-\_\-\-L\-S\-H\-\_\-\-C\-O\-N\-S\-T). \\
\hline
{\em rsh\-\_\-const} & \hyperlink{common_8hh_aa1542fdafaf6b27d057c000486b42133}{\-R\-S\-H} constant (\-T\-E\-A\-\_\-\-R\-S\-H\-\_\-\-C\-O\-N\-S\-T). \\
\hline
{\em \-A} & transition probability matrices for \-X\-O\-R $\mathrm{adp}^{\oplus}$ (\hyperlink{adp-xor_8hh_a42dda78d01cbb1a68263d971c1ab63ea}{adp\-\_\-xor\-\_\-sf}). \\
\hline
{\em \-A\-A} & transition probability matrices for \-X\-O\-R with fixed input $\mathrm{adp}^{\oplus}_{\mathrm{FI}}$ (\hyperlink{adp-xor-fi_8hh_a37c75fcba5d5904b75461ab35ff8d80d}{adp\-\_\-xor\-\_\-fixed\-\_\-input\-\_\-sf}). \\
\hline
{\em \-C} & unit column vector for computing $ \mathrm{adp}^{\oplus}$ (\hyperlink{adp-xor_8hh_ac720722a292fc8bb277b751e0b0be072}{adp\-\_\-xor}). \\
\hline
{\em da} & input difference to the \-F-\/function of \-X\-T\-E\-A. \\
\hline
{\em db} & output difference from the \-L\-S\-H operation in \-F. \\
\hline
{\em dc} & output difference from the \-R\-S\-H operation in \-F. \\
\hline
{\em dd} & output difference from the \-X\-O\-R operation in \-F. \\
\hline
{\em p} & probability of the partially constructed differential $(db[k:0], dc[k:0] \rightarrow dd[k:0])$ for the \-X\-O\-R operation in \-F. \\
\hline
{\em p\-\_\-thres} & probability threshold (default is \hyperlink{xtea_8hh_a33552d767f63f3e835002cbd0bfe52c4}{\-X\-T\-E\-A\-\_\-\-A\-D\-D\-\_\-\-P\-\_\-\-T\-H\-R\-E\-S}). \\
\hline
{\em diff\-\_\-set\-\_\-dx\-\_\-dy} & set of differentials $(dx \rightarrow dy)$ in the p\-D\-D\-T ordered by index $i = (dx~ 2^{n} + dy)$; stored in an \-S\-T\-L set structure, internally implemented as a \-Red-\/\-Black binary search tree.\\
\hline
\end{DoxyParams}
{\bfseries \-Algorithm} {\bfseries \-Outline\-:} 


\begin{DoxyEnumerate}
\item \-Recursively construct all differentials for the \-X\-O\-R operation in the $f_{\mathrm{LXR}}$ component of the \-F-\/function of \-X\-T\-E\-A (see \hyperlink{xtea_8hh_a54a13074da03742ac10ea2ea5f7eec0e}{xtea\-\_\-f\-\_\-lxr})\-: $ f_{\mathrm{LXR}}(a) = (((a \ll 4) \oplus (a \gg 5)) $. \-Note that when doing this, we treat the two inputs $(a \ll 4)$ and $(a \gg 5)$ as independent inputs, denoted respectively by $b$ and $c$. \-At every bit position in the recursion we require the corresponding partially constructed input differences $da,db,dc$ and the output difference $dd$ to satisfy conditions \hyperlink{tea-f-add-pddt_8hh_a55f531edb6fd0ce85c20b47e890475e3}{lsh\-\_\-condition\-\_\-is\-\_\-sat} and \hyperlink{tea-f-add-pddt_8hh_a9a9b0ca87b727a966ffb1842ffa389e3}{rsh\-\_\-condition\-\_\-is\-\_\-sat}. \-As a result, after the \-M\-S\-B is processed and $k = n$ the so constructed differences satisfy the following constions (see \hyperlink{tea-f-add-pddt_8hh_ae8e09fe95cc3eb4257b868d91f8924ec}{tea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-i})\-:
\begin{DoxyEnumerate}
\item $\mathrm{adp}^{3\oplus}(db, dc \rightarrow dd) > p_\mathrm{thres}$.
\item $db = da \ll 4$.
\item $dc \in {(da \ll R), (da \ll R) + 1, (da \ll R) - 2^{n-R}, (da \ll R) - 2^{n-R} + 1}$, so that $dc = (da \ll R)$ where $R =$\-T\-E\-A\-\_\-\-R\-S\-H\-\_\-\-C\-O\-N\-S\-T.
\end{DoxyEnumerate}
\item \-Set $dz = da + dd$ according to the feed-\/forward operation in \-F (see \hyperlink{xtea_8hh_a6c0b7a7bc47458fb343e66188fe4abda}{xtea\-\_\-f}) and compute the maximum probability output difference $dy$ for the \-A\-D\-D operation with round key and $\delta$ (see \hyperlink{xtea_8hh_a6c0b7a7bc47458fb343e66188fe4abda}{xtea\-\_\-f}) with one fixed input\-: $\mathrm{max}~\mathrm{adp}^{\oplus}_{\mathrm{FI}}((\mathrm{key} + \delta),~dz \rightarrow dy)$.
\item \-Experimentally adjust the probability of the differential $\mathrm{adp}^{F}(da \rightarrow dy)$ to the full function \-F using \hyperlink{adp-xtea-f-fk_8hh_a07bf299450a988931eb46ec5cca05150}{adp\-\_\-xtea\-\_\-f\-\_\-approx} . \-Set the adjusted probability to $\hat{p}$.
\item \-Store $(da, dy, \hat{p})$ in the p\-D\-D\-T.
\end{DoxyEnumerate}

\begin{DoxySeeAlso}{\-See also}
\hyperlink{tea-f-add-pddt_8hh_ae8e09fe95cc3eb4257b868d91f8924ec}{tea\-\_\-f\-\_\-add\-\_\-pddt\-\_\-i} 
\end{DoxySeeAlso}
